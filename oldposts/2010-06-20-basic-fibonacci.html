---
layout: post
title: Basic Fibonacci
date: '2010-06-20T01:55:00.001-07:00'
author: Hans Kruse
tags:
- vb.net
modified_time: '2016-08-25T23:37:43.461-07:00'
blogger_id: tag:blogger.com,1999:blog-1516417514149439988.post-8648974787192786644
blogger_orig_url: http://hcjkruse.blogspot.com/2010/06/basic-fibonacci.html
---

When I planned to do the Fibonacci sequence I wanted to do an IEnumerable(Of Integer) implementation first using the 'yield' keyword. Well that doesn't work in VB.NET because 'yield' is something specific for C#. I had to implement a full IEnumerable and IEnumerator ;(.  I started using a Console Project in Monodevelop. I wrote  a main program that will print the Fibonacci sequence from 0 to 44(maximum possible with integer).  <pre><span style='color: rgb(51,153,51)'>' Application.vb created with MonoDevelop </span><br /><span style='color: rgb(51,153,51)'>' User: kruse at 9:50 20-1-2009 </span><br /><span style='color: rgb(51,153,51)'>' </span><br /><span style='color: rgb(51,153,51)'>' To change standard headers go to Edit-&gt;Preferences-&gt;Coding-&gt;Standard Headers </span><br /><span style='color: rgb(51,153,51)'>' </span><br /><span style='color: rgb(0,0,255)'>Imports</span><span style='color: rgb(0,0,0)'> System.Collections </span><br /><span style='color: rgb(0,0,255)'>Imports</span><span style='color: rgb(0,0,0)'> System.Collections.Generic </span><br />NameSpace EUNemopolis <br /> <br /><span style='color: rgb(0,0,255)'>Public Class</span><span style='color: rgb(0,0,0)'> Application </span><br /><span style='color: rgb(0,0,255)'> Public Shared Sub</span><span style='color: rgb(0,0,0)'> Main() </span><br />  System.Console.WriteLine("Hello world!") <br />    <span style='color: rgb(0,0,255)'> Dim</span><span style='color: rgb(0,0,0)'> fibseq as FibEnumerable=new FibEnumerable() </span><br />    <span style='color: rgb(0,0,255)'> Dim</span><span style='color: rgb(0,0,0)'> fibenumerator as IEnumerator(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>)= fibseq.GetEnumerator() </span><br />    <span style='color: rgb(0,0,255)'> Dim</span><span style='color: rgb(0,0,0)'> fib as</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'> </span><br /> <span style='color: rgb(0,0,255)'> Dim</span><span style='color: rgb(0,0,0)'> i as</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'> </span><br />     for i=0 to 44 <br />      fib= fibenumerator.Current <br />      System.Console.Writeline(String.Format("{0:d},{1:d}",i,fib)) <br />      fibenumerator.MoveNext <br />     next <br /><span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><br /><span style='color: rgb(0,0,255)'>End Class</span><span style='color: rgb(0,0,0)'> </span><br /><span style='color: rgb(0,0,255)'>End</span><span style='color: rgb(0,0,0)'> NameSpace </span><br /></pre><p>Writing this program I already discovered that MonoDevelop is still missing intellisense and autocomplete. That would have been a real time saver. Also the mono compiler gave some cryptic errors on not having both System.Collections and System.Collections.Generic as imports.  With some googling in MSDN on IEnumerable and IEnumerator I managed to complete an implementation. My implementation consists of class that implements   IEnumerable(Of Integer). This class contains a private inner class that implements  IEnumerator(Of Integer) this class does the actual Fibonacci calculation. On the outside this enumerator is not visible. <pre><span style='color: rgb(51,153,51)'>' Fibonacci.vb created with MonoDevelop </span><br /><span style='color: rgb(51,153,51)'>' User: kruse at 14:10 22-1-2009 </span><br /><span style='color: rgb(51,153,51)'>' </span><br /><span style='color: rgb(51,153,51)'>' To change standard headers go to Edit-&gt;Preferences-&gt;Coding-&gt;Standard Headers </span><br /><span style='color: rgb(51,153,51)'>' </span><br /> <br /><span style='color: rgb(0,0,255)'>Option</span><span style='color: rgb(0,0,0)'> Explicit</span><span style='color: rgb(0,0,255)'> On</span><span style='color: rgb(0,0,0)'> </span><br /><span style='color: rgb(0,0,255)'>Option</span><span style='color: rgb(0,0,0)'> Strict</span><span style='color: rgb(0,0,255)'> On</span><span style='color: rgb(0,0,0)'> </span><br /> <br /><span style='color: rgb(0,0,255)'>Imports</span><span style='color: rgb(0,0,0)'> System </span><br /><span style='color: rgb(0,0,255)'>Imports</span><span style='color: rgb(0,0,0)'> System.Collections </span><br /><span style='color: rgb(0,0,255)'>Imports</span><span style='color: rgb(0,0,0)'> System.Collections.Generic </span><br /> <br /><span style='color: rgb(0,0,255)'>Namespace</span><span style='color: rgb(0,0,0)'> EUNemopolis </span><br /><span style='color: rgb(0,0,255)'> Public Class</span><span style='color: rgb(0,0,0)'> FibEnumerable </span><br /><span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IEnumerable(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>) </span><br />     <span style='color: rgb(0,0,255)'> Public Sub New</span><span style='color: rgb(0,0,0)'>() </span><br />    MyBase.New() <br />  <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr> <span style='color: rgb(0,0,255)'> Public Function</span><span style='color: rgb(0,0,0)'> GetEnumerator()</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(0,0,0)'> IEnumerator(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>) _ </span><br /> <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IEnumerable(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>).GetEnumerator </span><br />     <span style='color: rgb(0,0,255)'> Return New</span><span style='color: rgb(0,0,0)'> FibEnumerator() </span><br /> <span style='color: rgb(0,0,255)'> End Function</span><span style='color: rgb(0,0,0)'> </span><hr> <span style='color: rgb(0,0,255)'> Private Function</span><span style='color: rgb(0,0,0)'> GetEnumerator1()</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(0,0,0)'> IEnumerator _ </span><br /> <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IEnumerable.GetEnumerator </span><br />     <span style='color: rgb(0,0,255)'> Return</span><span style='color: rgb(0,0,0)'> GetEnumerator() </span><br /> <span style='color: rgb(0,0,255)'> End Function</span><span style='color: rgb(0,0,0)'> </span><hr>    <span style='color: rgb(0,0,255)'> Private Class</span><span style='color: rgb(0,0,0)'> FibEnumerator </span><br />    <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IEnumerator(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>) </span><br />  <span style='color: rgb(0,0,255)'> Private</span><span style='color: rgb(0,0,0)'> _n</span><span style='color: rgb(0,0,255)'> As Integer</span><span style='color: rgb(0,0,0)'> </span><br />  <span style='color: rgb(0,0,255)'> Private</span><span style='color: rgb(0,0,0)'> _current</span><span style='color: rgb(0,0,255)'> As Integer</span><span style='color: rgb(0,0,0)'> </span><br />  <span style='color: rgb(0,0,255)'> Private</span><span style='color: rgb(0,0,0)'> _previous</span><span style='color: rgb(0,0,255)'> As Integer</span><span style='color: rgb(0,0,0)'> </span><br />     <span style='color: rgb(0,0,255)'> Public Sub New</span><span style='color: rgb(0,0,0)'>() </span><br />    MyBase.New() <br />     Init() <br />   <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr>      <br />  <span style='color: rgb(0,0,255)'> Public ReadOnly Property</span><span style='color: rgb(0,0,0)'> Current()</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(0,0,0)'> integer _ </span><br />  <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IEnumerator(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>).Current </span><br />       <span style='color: rgb(0,0,255)'> Get</span><span style='color: rgb(0,0,0)'> </span><br />        <span style='color: rgb(0,0,255)'> Return</span><span style='color: rgb(0,0,0)'> _current </span><br />       <span style='color: rgb(0,0,255)'> End Get</span><span style='color: rgb(0,0,0)'> </span><br />  <span style='color: rgb(0,0,255)'> End Property</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'> Private</span><span style='color: rgb(0,0,0)'> </span><span style='color: rgb(0,0,255)'> ReadOnly Property</span><span style='color: rgb(0,0,0)'> Current1()</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(153,0,204)'> Object</span><span style='color: rgb(0,0,0)'>  _ </span><br />  <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IEnumerator.Current </span><br />      <span style='color: rgb(0,0,255)'> Get</span><span style='color: rgb(0,0,0)'> </span><br />          <span style='color: rgb(0,0,255)'> Return</span><span style='color: rgb(0,0,0)'> Me.Current </span><br />      <span style='color: rgb(0,0,255)'> End Get</span><span style='color: rgb(0,0,0)'> </span><br /><span style='color: rgb(0,0,255)'>End Property</span><span style='color: rgb(0,0,0)'> </span><hr>  <span style='color: rgb(0,0,255)'> Public Function</span><span style='color: rgb(0,0,0)'> MoveNext()</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(153,0,204)'> Boolean</span><span style='color: rgb(0,0,0)'> _ </span><br />  <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> System.Collections.IEnumerator.MoveNext </span><br />       _n=_n+1 <br />      <span style='color: rgb(0,0,255)'> If</span><span style='color: rgb(0,0,0)'> _n&lt;=2</span><span style='color: rgb(0,0,255)'> Then</span><span style='color: rgb(0,0,0)'> </span><br />        _previous=_current <br />        _current=_n <br />      <span style='color: rgb(0,0,255)'> Else</span><span style='color: rgb(0,0,0)'> </span><br />       <span style='color: rgb(0,0,255)'> Dim</span><span style='color: rgb(0,0,0)'> newCurrent as</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'> </span><br />        newCurrent=_previous+_current <br />        _previous=_current <br />        _current=newCurrent <br />      <span style='color: rgb(0,0,255)'> End If</span><span style='color: rgb(0,0,0)'> </span><br />      <span style='color: rgb(0,0,255)'> Return</span><span style='color: rgb(0,0,0)'> True </span><br />     <span style='color: rgb(0,0,255)'> End Function</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'> Public Sub</span><span style='color: rgb(0,0,0)'> Reset() _ </span><br />     <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> System.Collections.IEnumerator.Reset </span><br />       Init() <br />  <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'> Private Sub</span><span style='color: rgb(0,0,0)'> init() </span><br />    _n=0 <br />    _current=0 <br />    _previous=0 <br /> <br />  <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'> Public Sub</span><span style='color: rgb(0,0,0)'> Dispose() _ </span><br />  <span style='color: rgb(0,0,255)'> Implements</span><span style='color: rgb(0,0,0)'> IDisposable.Dispose </span><br />   <span style='color: rgb(51,153,51)'>' Empty implementation </span><br />  <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'> End Class</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'> End Class</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'>End Namespace</span><span style='color: rgb(0,0,0)'> </span><br /></pre><p>For those interested I use <a href="http://sourceforge.net/projects/karekol/">Karekol</a> for  vb.net sourcecode to html conversion. This concludes my first implementation of the Fibonacci sequence  in VB.NET. Later I will continue with one of the items mentioned in the previous blogpost.  </p>