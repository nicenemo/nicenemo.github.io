---
layout: post
title: My First Fibonacci workflow
date: '2010-06-20T01:57:00.001-07:00'
author: Hans Kruse
tags:
- vb.net
modified_time: '2016-08-25T23:37:43.457-07:00'
thumbnail: http://2.bp.blogspot.com/_tXGm93SSyrs/SXm_ItZQK-I/AAAAAAAACyM/TzfiYxTk4Qg/s72-c/FirstFibWorkflow.jpg
blogger_id: tag:blogger.com,1999:blog-1516417514149439988.post-6404137154835309456
blogger_orig_url: http://hcjkruse.blogspot.com/2010/06/my-first-fibonacci-workflow.html
---

<p>When supporting a business with software one often draws diagram of the so called business processes. These diagram describe the flow, the work flow, of the business process.  Since .NET 3.0 there is built-in support for work flows which is augmented with a nice Visual Designer in Visual Studio 2008. With this Designer one design the work flows graphically. These designs can be used as a means of communication to the customer and between programmer and business annalist.  </p><p>This is something I wanted to try with my Fibonacci Generator. So I started Visual Studio and used a VB.NET Console application template with workflow support. That gave me an almost empty canvas that asked me to drag a so called workflow activity on it. In the toolbox there are many different activities/workflow constructs Such as While, If/Then, Webservice, Code, Parallelization and many more.  <h3>My First Workflow</h3>My First workflow will be simple: </p><ul><li>It Contains a <em>code</em> activity that prints the next Fibonacci number to the Console and move to the next Fibonacci Number;</li><li>I use a Workflow <em>while</em> construct to stay below 45 Since the 44th Fibonacci number is the largest that fits in an Integer;</li><li>Use a <em>Sleep</em> activity that Sleeps for 15 Seconds so that we can see the result in the console</li></ul><p>Graphically this is shown in Visual Studio as follows:  <a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_tXGm93SSyrs/SXm_ItZQK-I/AAAAAAAACyM/TzfiYxTk4Qg/s1600-h/FirstFibWorkflow.jpg"><img style="float:right; margin:0 0 10px 10px;cursor:pointer; cursor:hand;width: 320px; height: 162px;" src="http://2.bp.blogspot.com/_tXGm93SSyrs/SXm_ItZQK-I/AAAAAAAACyM/TzfiYxTk4Qg/s320/FirstFibWorkflow.jpg" border="0" alt=""id="BLOGGER_PHOTO_ID_5294472993296100322" /></a> </br> </p><p>This is a very simple sequential workflow with conditional iteration. In the code behind the conditions and the part for the code blob are programmed. Actually this should only refer to code defined elsewhere and not be used for your actual programming. </p><pre><span style='color: rgb(0,0,255)'>Namespace</span><span style='color: rgb(0,0,0)'> EUNemopolis </span><br />   <span style='color: rgb(0,0,255)'> Public Class</span><span style='color: rgb(0,0,0)'> FibWorkflow </span><br />       <span style='color: rgb(0,0,255)'> Inherits</span><span style='color: rgb(0,0,0)'> SequentialWorkflowActivity </span><br />       <span style='color: rgb(0,0,255)'> Private</span><span style='color: rgb(0,0,0)'> MyFibEnumerator</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(0,0,0)'> IEnumerator(Of</span><span style='color: rgb(0,0,255)'> Integer</span><span style='color: rgb(0,0,0)'>) </span><br />       <span style='color: rgb(0,0,255)'> Private</span><span style='color: rgb(0,0,0)'> MyCounter</span><span style='color: rgb(0,0,255)'> As Integer</span><span style='color: rgb(0,0,0)'> </span><br /> <br />       <span style='color: rgb(0,0,255)'> Public Sub New</span><span style='color: rgb(0,0,0)'>() </span><br /> <br />            <span style='color: rgb(51,153,51)'>' This call is required by the Windows Form Designer. </span><br />            InitializeComponent() <br /> <br />            MyFibEnumerator =<span style='color: rgb(0,0,255)'> New</span><span style='color: rgb(0,0,0)'> FibEnumerable().GetEnumerator() </span><br />            MyCounter = 0 <br />       <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr>       <span style='color: rgb(0,0,255)'> Public ReadOnly Property</span><span style='color: rgb(0,0,0)'> CurrentFib() </span><br />           <span style='color: rgb(0,0,255)'> Get</span><span style='color: rgb(0,0,0)'> </span><br />               <span style='color: rgb(0,0,255)'> Return</span><span style='color: rgb(0,0,0)'> MyFibEnumerator.Current </span><br />           <span style='color: rgb(0,0,255)'> End Get</span><span style='color: rgb(0,0,0)'> </span><br />       <span style='color: rgb(0,0,255)'> End Property</span><span style='color: rgb(0,0,0)'> </span><hr>       <span style='color: rgb(0,0,255)'> Private Sub</span><span style='color: rgb(0,0,0)'> NextFib(ByVal sender</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(153,0,204)'> System.Object</span><span style='color: rgb(0,0,0)'>,</span><span style='color: rgb(0,0,255)'> ByVal</span><span style='color: rgb(0,0,0)'> e</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(153,0,204)'> System.EventArgs</span><span style='color: rgb(0,0,0)'>) </span><br />            Console.WriteLine(String.Format("{0:d},{1:d}", MyCounter, MyFibEnumerator.Current)) <br />            MyFibEnumerator.MoveNext() <br />            MyCounter = MyCounter + 1 <br />       <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr> <br />       <span style='color: rgb(0,0,255)'> Private Sub</span><span style='color: rgb(0,0,0)'> FitsInType(ByVal sender</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(153,0,204)'> System.Object</span><span style='color: rgb(0,0,0)'>,</span><span style='color: rgb(0,0,255)'> ByVal</span><span style='color: rgb(0,0,0)'> e</span><span style='color: rgb(0,0,255)'> As</span><span style='color: rgb(0,0,0)'> System.Workflow.Activities.ConditionalEventArgs) </span><br />            e.Result = (MyCounter &lt; 45) <br />       <span style='color: rgb(0,0,255)'> End Sub</span><span style='color: rgb(0,0,0)'> </span><hr> <br /> <br />   <span style='color: rgb(0,0,255)'> End Class</span><span style='color: rgb(0,0,0)'> </span><hr><span style='color: rgb(0,0,255)'>End Namespace</span><span style='color: rgb(0,0,0)'> </span><br /></pre><p>Besides the code I have written, which is shown above, the template generator generates some initialisation code. The Designer also generates supporting initialization code when dragging and dropping activities to the workflow canvas. </p><p>Of course this example is far from some actual business case. However It gives the opportunity to make oneself familiar with the basics of Work flows in .NET 3.0 and 3.5 without the hassle of having to configure web services or building some GUI application that fires events that are consumed by the work flow. I am particulary interested in combining work flow with email since many busines proces involve sending notification E-Mail messages to people. The Default Set of activities in the toolbox does not contain support for E-Mail. I have to look online for an E-Mail component or make one myself. More on that in a later blog post. </p>