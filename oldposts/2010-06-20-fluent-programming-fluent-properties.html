---
layout: post
title: Fluent Programming, Fluent Properties
date: '2010-06-20T02:19:00.001-07:00'
author: Hans Kruse
tags:
- vb.net
modified_time: '2016-08-26T00:12:34.357-07:00'
blogger_id: tag:blogger.com,1999:blog-1516417514149439988.post-7928768246082663538
blogger_orig_url: http://hcjkruse.blogspot.com/2010/06/fluent-programming-fluent-properties.html
---

<p>Currently Fluent Programming is a hype. You see it in clientside webprogramming, you see it in .NET programmming and I think it is safe to asume it has been, is or will be fashionable in other environments to. You find fluent interfaces within the .NET framework in the LINQ libraries. </p><p>The idea of fluent interfaces is that you structure your code in such a way that you can continue chaining methods on a line. In the example below we create a FluentPerson, and like in this sentence which is way to long and uses commas to chain, we continue, by setting the <em>Age</em>, the <em>Name</em>, let it <em>Dance</em> and finally give it a <em>Rest</em>. </p><pre>New FluentPerson().Age(34).Name("Hans").Dance().Rest()<br /></pre><em>Example of fluent Programming</em> <p>If we observe a typical class like the example Person class below you will notice that the code above cannot work because we have Subs(void methods) that do not return results and property setters that do not return results either. </p><pre>Public Class  Person<br />   Default public Property Name As String<br />      Get <br />        return nameField<br />      End Get<br />      Set(value as String)<br />         nameField=value<br />      End Set<br />   End Property<br />   Protected nameField as String<br />  <br />   Public Property Age As Integer<br />      Get <br />         return ageField<br />      end Get<br />         Set(value as Integer)<br />         ageField=value<br />      End Set<br />   End Property<br />   Protected ageField as Integer<br /> <br />   Public Sub Dance()<br />      Console.WriteLine("Salsa!!")<br />   End Sub<br /><br />   Public Sub Rest()<br />      Console.WriteLine("Relax")<br />   End Sub<br />End Class<br /></pre><em>Example Person Class</em>  <p>To Make this work in VB.NET/C# you have to: <ul><li>Change all Subs/void functions and propperty setters into function calls,</li><li>Let these function calls return the current object after they have done their thing.</li></ul>Changing Subs into functions will not be a problem but not using properties breaks expectations from both fellow programmers and tools. So we are going to keep the properties but add an extra property setter method that just calls the Property Setter and then returns the current object. <p>In our example code we remove the <em>Dance</em> and <em>Rest</em> methods from our Person class. We add the following Fluent Subclass: </p><pre>Public Class FluentPerson<br />Inherits Person<br />   Public function SetName(Byval name as String) as FluentPerson<br />      nameField=name<br />      return Me<br />   End Function<br /><br />   Public function SetAge(Byval age as Integer) as FluentPerson<br />      ageField=age<br />      return Me<br />   End Function<br /> <br />   Public Function Dance() As FluentPerson<br />      Console.Writeline("Salsa!!!")<br />      return Me<br />   End Function<br />   Public Function Rest() As FluentPerson<br />      Console.WriteLine("Relax")<br />   End Function<br />End Class<br /></pre><p>Now we are able to make a fluent call like: </p><pre>dim fp as FluentPerson =New FluentPerson().setAge(34).setName("Hans").Dance().Rest() <br /></pre><p>Setting the properties here could have been done with the appropriate constructors. We did not include them in the sample code. Property initalizers could not have been used. They are like a normal " With" statement and do not return a result. The solution presented here is more verbose than the original example but we think it is an acceptable compromis.  </p><p>Fluent programming has two disadvantages: </p><ul><li>A chain of fluent method calls is harder to debug. You can only set one breakpoint</li><li>It is a bit more work for the person making the class</li></ul><p>Suggestions for improvement are welcome. </p>