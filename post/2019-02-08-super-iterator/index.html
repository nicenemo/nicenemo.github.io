<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <meta property="og:title" content="The super lazy iterator in C# and Java" />
<meta property="og:description" content="A super lazy iterator is known by functional programmers as the List Monad. This is not another Monad tutorial but focusses on what was added to C# and Java to allow retrofitting this super lazy iterator to C# and Java.
With this super iterator you can:
 Iterate over a collection skipping elements by predicate. where clause or filter. Project the elements in a collection into something different select clause, project or map." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hanskruse.eu/post/2019-02-08-super-iterator/" />
<meta property="article:published_time" content="2019-02-08T08:56:38+01:00" />
<meta property="article:modified_time" content="2019-02-08T08:56:38+01:00" />

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The super lazy iterator in C# and Java"/>
<meta name="twitter:description" content="A super lazy iterator is known by functional programmers as the List Monad. This is not another Monad tutorial but focusses on what was added to C# and Java to allow retrofitting this super lazy iterator to C# and Java.
With this super iterator you can:
 Iterate over a collection skipping elements by predicate. where clause or filter. Project the elements in a collection into something different select clause, project or map."/>

        
        <title>
  The super lazy iterator in C# and Java | Hans Kruse
</title>

        <link rel="icon" type="image/png" href='https://hanskruse.eu/images/favicon-16x16.png' sizes="16x16">
        <link rel="icon" type="image/png" href='https://hanskruse.eu/images/favicon-32x32.png' sizes="32x32">  

        <link href="https://fonts.googleapis.com/css?family=Oswald:400" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">      
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
        
        
        
        

        <link rel="stylesheet" href="https://hanskruse.eu/css/bundle.min.b97f193de70a99ff0493bab9f65bdc1a4620f1d92b801069ccd3b39cd1f972f5.css" integrity="sha256-uX8ZPecKmf8Ek7q59lvcGkYg8dkrgBBpzNOznNH5cvU="  />

        
    <link rel="icon" type="image/png" href="https://hanskruse.eu/images/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://hanskruse.eu/images/favicon-32x32.png" sizes="32x32">

<link rel="alternate" type="application/rss+xml" href='https://hanskruse.eu/index.xml' />

<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="author" content="Hans Kruse" />
<meta name="copyright" content="Copyright © 2014–2019, Hans Kruse  all rights reserved." />


<meta name="description" content="A super lazy iterator is known by functional programmers as the List Monad. This is not another Monad tutorial but focusses on what was added to C# and Java to allow retrofitting this super lazy iterator to C# and Java.
With this super iterator you can:
 Iterate over a collection skipping elements by predicate. where clause or filter. Project the elements in a collection into something different select clause, project or map.">


    
        
    </head>
    <body>
        <nav class="navbar fixed-top navbar-expand-md navbar-dark bg-dark py-1 top-nav">
            <div class="container">
                    <a class="navbar-brand pr-2" href="https://hanskruse.eu/">HANS KRUSE</a>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="navbar-collapse collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
    <a class="nav-link active" href="https://hanskruse.eu/about/">About</a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="https://resume.hanskruse.eu">Resume</a>
</li>

                    </ul>
                    <div class="social-icons d-none d-lg-block">
                        <a class="py-2 px-2" href='https://hanskruse.eu/index.xml'><i class="fas fa-rss"></i></a>

                    </div>
                </div>
            </div>
        </nav>

        
<header class="feature-image d-print-none">
</header>

        
        <div class="main">
            
<div class="container mt-4 post">
    <h1>The super lazy iterator in C# and Java</h1>
    <div class="mb-3">
    <small>
        <strong>By Hans Kruse</strong>
        | <i class="far fa-calendar-alt"></i>&nbsp;Feb 8, 2019&nbsp;
        | <i class="fa fa-tags" title="Tags" aria-hidden="true"></i> 
    </small>
</div>

    <div class="share-icons d-flex justify-content-center d-print-none">
        <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fhanskruse.eu%2fpost%2f2019-02-08-super-iterator%2f&text=The%20super%20lazy%20iterator%20in%20C%23%20and%20Java&tw_p=tweetbutton" class="p-2" title="Share on Twitter" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Tweet</small></div>
</a>

<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fhanskruse.eu%2fpost%2f2019-02-08-super-iterator%2f&t=The%20super%20lazy%20iterator%20in%20C%23%20and%20Java" class="p-2" title="Share on Facebook" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fhanskruse.eu%2fpost%2f2019-02-08-super-iterator%2f&title=The%20super%20lazy%20iterator%20in%20C%23%20and%20Java&source=mattbutton.com" class="p-2" title="Share on LinkedIn" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="javascript:window.print()" title="Print this article" class="p-2" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fa fa-print fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Print</small></div>
</a>
    </div>

    <div class="mt-4 mb-4 main-content">
        <p>A <em>super lazy iterator</em> is known by functional programmers as the <a href="https://www.schoolofhaskell.com/school/starting-with-haskell/basics-of-haskell/13-the-list-monad">List Monad</a>.  This is not another Monad tutorial but focusses on what was added to C# and Java to allow retrofitting this <em>super lazy iterator</em> to C# and Java.</p>

<p>With this <em>super</em> iterator you can:</p>

<ul>
<li>Iterate over a collection skipping elements by predicate. <em>where clause</em> or <em>filter</em>.</li>
<li>Project the elements in a collection into something different <em>select clause</em>, <em>project</em> or <em>map</em>. This is done using a function reference or lambda expression.</li>
<li>Flatten a collection of collections of items into a collection of items <em>select many</em> or <em>flatmap</em>.</li>
<li>Aggregate, reduce or collect a collection items into a single value</li>
</ul>

<p>Except for aggregation, the operation of this <em>super iterator</em> are lazy and chainable. Only when you aggregate or transform the iterator in a collection again, the <em>filter</em>, <em>map</em> and <em>flatmap</em> operations are executed for real.</p>

<p>The benefit of this iterator is that provides a set of useful composable operations with a mathematical foundation. You can proof that your code is correct (as long as it is side effect free). The code is usually more succinct and readable than more traditional imperative code. However I can imagine that it may take some time to getting used to reading it.</p>

<p>Debugging this kind of code is a bit harder but hardly necessary. You debug the parts, not the composition.</p>

<p>The <em>super lazy iterator</em> was retrofitted to .NET in 2007, version 3.5 as Language Integrated query, <a href="https://en.wikipedia.org/wiki/Language_Integrated_Query">LINQ</a>. Both a library and extended syntax in C# and and VB.NET were added. Existing collection APIs can be used with LINQ. To be more acceptable a syntax with SQL like keywords was used. LINQ is build on top of Lambda expressions and <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods">Extension methods</a> that were added in .NET 3.0. The <code>Enumaration</code> extension class provides enables the use of LINQ with the existing .NET collection classes. Extension methods allow you to define methods in a separate class and use them as if they were part of an existing class or interface. This will also work with <code>sealed</code> classes.</p>

<p>The <em>super lazy iterator</em> was introduced to Java in 2014 with Java 8. In Java 8 you can find it in the <code>java.util.streams.*</code> API.  This has no relation to IO streams. Also in Java support for Lambda expressions was added to support the new <code>streams</code> API. The Java collections interfaces were retrofitted with an additional <code>.stream()</code> method. Adding extra methods to existing interfaces would break your code. This is because you do not have implementations for these new methods. This problem was tackled by addding the new language feature, <a href="https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html">default method</a>. This allows you to provide a default implementation for those newly added methods within the interface.</p>

<p>In Java there is no further sytactical sugar to support the <em>super iterator</em>. Special Stream classes exists for Java primitives. In .NET additional support for meta programming in LINQ using expression trees is available. In VB.NET special LINQ support for XML files is added at the language level. The <em>foreach</em> statement in C# and VB.NET act different when using LINQ. With LINQ you can do list comprehension using the language support. This gets translated into <em>flatmap</em> calls.</p>

<p>Extension methods in .NET and default interface implementations in Java are used for refactoring code by providing tested utility methods within existing code bases.
I used both for writing utility libraries. In Java well known libraries that use default methods are <a href="https://site.mockito.org/">Mockito</a> and <a href="https://github.com/quicktheories/QuickTheories">QuickTheories</a>. Besides my own code I have not used third party .NET libraries that provide functionality in the form of extension methods.</p>

<p>I am a LINQ and streams fan and also like extension methods and default methods What do you think about Java Streams or LINQ? How are you using it? What about extension methods and default methods?</p>


        <div class="share-icons d-flex justify-content-center d-print-none">
            <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fhanskruse.eu%2fpost%2f2019-02-08-super-iterator%2f&text=The%20super%20lazy%20iterator%20in%20C%23%20and%20Java&tw_p=tweetbutton" class="p-2" title="Share on Twitter" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Tweet</small></div>
</a>

<a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fhanskruse.eu%2fpost%2f2019-02-08-super-iterator%2f&t=The%20super%20lazy%20iterator%20in%20C%23%20and%20Java" class="p-2" title="Share on Facebook" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-facebook fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fhanskruse.eu%2fpost%2f2019-02-08-super-iterator%2f&title=The%20super%20lazy%20iterator%20in%20C%23%20and%20Java&source=mattbutton.com" class="p-2" title="Share on LinkedIn" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Share</small></div>
</a>

<a href="javascript:window.print()" title="Print this article" class="p-2" target="_blank" rel="nofollow">
    <div>
        <span class="fa-stack">
            <i class="fas fa-circle fa-stack-2x"></i>
            <i class="fa fa-print fa-stack-1x fa-inverse"></i>
        </span>
    </div>
    <div class="fa-inverse text-center"><small>Print</small></div>
</a>
        </div>
    </div>

    
</div>
<div class="sidebar d-print-none d-none d-xl-block">
    
        <h2>Hans Kruse</h2>
        <div>
            Monadic  programmer - Software Engineer with a passion for cooking.
        </div>
        <a href='https://hanskruse.eu/about/' class="btn btn-outline-secondary mt-3" role="button">Read More...</a>
        <h2 class="mt-4">Top Posts</h2>
    
    
    <h2 class="mt-4">Recent Posts</h2>
    <nav class="nav flex-column">
        
        <a href="https://hanskruse.eu/post/2019-02-08-super-iterator/" class="nav-link">The super lazy iterator in C# and Java</a>
        
        <a href="https://hanskruse.eu/post/2018-09-04-vanilla-java/" class="nav-link">Vanilla Java for stream copy</a>
        
    </nav>
    
    <h2 class="mt-4 text-capitalize">categories</h2>
    <nav class="nav flex-column">
        
        <a href='https://hanskruse.eu/categories/java/' class="nav-link">
        java
        <span class="badge badge-pill badge-secondary">2</span>
        </a>
        
        <a href='https://hanskruse.eu/categories/programming/' class="nav-link">
        programming
        <span class="badge badge-pill badge-secondary">2</span>
        </a>
        
        <a href='https://hanskruse.eu/categories/design-pattern/' class="nav-link">
        design-pattern
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
        <a href='https://hanskruse.eu/categories/functional-programming/' class="nav-link">
        functional-programming
        <span class="badge badge-pill badge-secondary">1</span>
        </a>
        
    </nav>
    
    <h2 class="mt-4 text-capitalize">tags</h2>
    <nav class="nav flex-column">
        
    </nav>
    
</div>

        </div>

        <footer class="mt-auto footer d-print-none">
            <div class="container-fluid">
                <div class="row justify-content-center">
                    <div class="col-md-4 col-xl-3">
                        <h5>Copyright © 2014–2019, Hans Kruse  all rights reserved.</h5>
Feel free to share this content non commercially, Attribution-NonCommercial-ShareAlike
                    </div>
                    <div class="col-md-4 col-xl-3">
                        <h5>Disclaimer</h5>
Opinions expressed here are my own and may not reflect those of the company I work for, or the people I work with.
                    </div>
                    <div class="col-md-4 col-xl-3">
                        <h5>About This Site</h5>
This blog was created using the <a href="https://gohugo.io/">Hugo</a> static site generator, using
<a href="https://getbootstrap.com/">Bootstrap</a>, using the Silhouette Hugo theme, created by
<a href='https://www.mattbutton.com'>Matt Button</a>
                    </div>
                </div>

                <hr />

                <div class="d-flex justify-content-center icons">
                    <a class="py-2 px-2" href='https://hanskruse.eu/index.xml'><i class="fas fa-rss"></i></a>

                </div>
            </div>
        </footer>

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

        
    </body>
</html>
